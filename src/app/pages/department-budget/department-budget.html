<div class="budget-page">

  <!-- ==== SUMMARY CARDS ==== -->
  <div class="summary-container">

    <div class="summary-card">
      <label>Total Budget</label>
      <h2>{{ totalBudget | number }} EGP</h2>
    </div>

    <div class="summary-card">
      <label>Total Income</label>
      <h2>{{ incomeTotal | number }} EGP</h2>
    </div>

    <div class="summary-card">
      <label>Total Expenses</label>
      <h2>{{ expenseTotal | number }} EGP</h2>
    </div>

    <div class="summary-card">
      <label>Remaining Balance</label>
      <h2>{{ balance | number }} EGP</h2>
    </div>

  </div>

  <!-- ==== ADD BUTTON ==== -->
  <button class="add-btn" (click)="openModal()">+ Add Entry</button>

  <!-- ==== CHARTS ==== -->
  <div class="charts">
    <div class="chart-box">
      <canvas id="pieChart"></canvas>
    </div>

    <div class="chart-box">
      <canvas id="barChart"></canvas>
    </div>
  </div>

  <!-- ==== TABLE ==== -->
  <table class="budget-table">

    <thead>
      <tr>
        <th>Category</th>
        <th>Type</th>
        <th>Amount</th>
        <th>Date</th>
        <th>Description</th>
        <th>Invoice</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let x of items">

        <td>{{ x.category }}</td>

        <td>
          <span class="tag" [class.income]="x.type==='INCOME'" [class.expense]="x.type==='EXPENSE'">
            {{ x.type }}
          </span>
        </td>

        <td>{{ x.amount }} EGP</td>
        <td>{{ x.date }}</td>
        <td>{{ x.description }}</td>

        <td>
          <a *ngIf="x.invoice" class="download" (click)="download(x)">Download</a>
          <span *ngIf="!x.invoice" class="none">-</span>
        </td>

        <td><button class="delete" (click)="remove(x.id)">âœ•</button></td>

      </tr>
    </tbody>

  </table>



  <!-- ==== MODAL ==== -->
  <div class="modal" *ngIf="show">

    <div class="modal-box">

      <h3>Add New Entry</h3>

      <label>Category</label>
      <select [(ngModel)]="form.category">
        <option>Salaries</option>
        <option>Maintenance</option>
        <option>Equipment</option>
        <option>Events</option>
        <option>Lab Supplies</option>
        <option>Software Licenses</option>
      </select>

      <label>Type</label>
      <select [(ngModel)]="form.type">
        <option value="INCOME">Income</option>
        <option value="EXPENSE">Expense</option>
      </select>

      <label>Amount</label>
      <input type="number" [(ngModel)]="form.amount">

      <label>Date</label>
      <input type="date" [(ngModel)]="form.date">

      <label>Description</label>
      <textarea rows="2" [(ngModel)]="form.description"></textarea>

      <label>Upload Invoice</label>
      <input type="file" (change)="upload($event)">

      <div class="actions">
        <button class="primary" (click)="save()">Save</button>
        <button class="secondary" (click)="close()">Cancel</button>
      </div>

    </div>

  </div>

</div>
